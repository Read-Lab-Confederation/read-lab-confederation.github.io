<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>EMERGENT | Help, I have too many genome sequences!</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.79.1"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link href=/dist/css/app.d98f2eb6bcd1eaedb7edf166bd16af26.css rel=stylesheet><link rel=stylesheet href=/css/custom.css><meta property="og:title" content="Help, I have too many genome sequences!"><meta property="og:description" content="Said no one, ever. Right? (tl;dr at bottom) In a recent publication(1), we analysed the quorum sensing operon of > 40,000 Staphylococcus aureus genomes to identify recurring patterns of genetic variation. To infer transmission of specific mutations, we were tasked with constructing phylogenies for multiple clonal lineages, each comprising thousands of isolates(1).
Whole genome maximum likelihood phylogeny construction is a both time and computation-intensive process, especially for large numbers of tips."><meta property="og:type" content="article"><meta property="og:url" content="https://read-lab-confederation.github.io/blog/posts/derep_blog/"><meta property="article:published_time" content="2022-01-21T00:00:00+00:00"><meta property="article:modified_time" content="2022-01-21T00:00:00+00:00"><meta itemprop=name content="Help, I have too many genome sequences!"><meta itemprop=description content="Said no one, ever. Right? (tl;dr at bottom) In a recent publication(1), we analysed the quorum sensing operon of > 40,000 Staphylococcus aureus genomes to identify recurring patterns of genetic variation. To infer transmission of specific mutations, we were tasked with constructing phylogenies for multiple clonal lineages, each comprising thousands of isolates(1).
Whole genome maximum likelihood phylogeny construction is a both time and computation-intensive process, especially for large numbers of tips."><meta itemprop=datePublished content="2022-01-21T00:00:00+00:00"><meta itemprop=dateModified content="2022-01-21T00:00:00+00:00"><meta itemprop=wordCount content="1121"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Help, I have too many genome sequences!"><meta name=twitter:description content="Said no one, ever. Right? (tl;dr at bottom) In a recent publication(1), we analysed the quorum sensing operon of > 40,000 Staphylococcus aureus genomes to identify recurring patterns of genetic variation. To infer transmission of specific mutations, we were tasked with constructing phylogenies for multiple clonal lineages, each comprising thousands of isolates(1).
Whole genome maximum likelihood phylogeny construction is a both time and computation-intensive process, especially for large numbers of tips."><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-148959477-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><link href=/css/share-button.css rel=stylesheet></head><body class="ma0 avenir bg-near-white"><header class="cover bg-top" style=background-image:url(https://read-lab-confederation.github.io/images/Vishnu_Fig2.png)><div class="pb3-m pb6-l bg-black-60"><nav class="pv3 ph3 ph4-ns tc tl-l" role=navigation><div class="flex-l justify-between items-center center"><a href=https://read-lab-confederation.github.io class="f3 fw2 hover-white no-underline white-90 dib">EMERGENT</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f7 f4-ns fw4 dib pr1 pr3-ns"><a class="hover-white no-underline white-90" href=/about/ title="About page">About</a></li><li class="list f7 f4-ns fw4 dib pr1 pr3-ns"><a class="hover-white no-underline white-90" href=/blog/ title="Blog page">Blog</a></li><li class="list f7 f4-ns fw4 dib pr1 pr3-ns"><a class="hover-white no-underline white-90" href=/group/ title="Group page">Group</a></li><li class="list f7 f4-ns fw4 dib pr1 pr3-ns"><a class="hover-white no-underline white-90" href=/research/ title="Research page">Research</a></li><li class="list f5 f4-ns fw4 dib pr1 pr3-ns"></li></ul></div></div></nav><div class="tc-l pv6-l pv4 ph3 ph4-ns"><h1 class="dib-ns dn f1-ns fw2 white-90 mb0 lh-title">Help, I have too many genome sequences!</h1></div></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><p class="f6 b helvetica tracked">POSTS</p><h1 class="f3-ns f4 athelas mb1">Help, I have too many genome sequences!</h1><time class="f6 dib tracked" datetime=2022-01-21T00:00:00Z>January 21, 2022</time><div class=author-info><p class=author-name>Vishnu Raghuram</p></div></header><section class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-80-l"><p><a href=https://doi.org/10.5281/zenodo.7278310><img src=https://zenodo.org/badge/DOI/10.5281/zenodo.7278310.svg alt=DOI></a></p><h4 id=said-no-one-ever-right>Said no one, ever. Right?</h4><h6 id=tldr-at-bottom>(tl;dr at bottom)</h6><p>In <a href=https://journals.asm.org/doi/10.1128/spectrum.01334-21>a recent publication</a>(1), we analysed the quorum sensing operon of > 40,000 <em>Staphylococcus aureus</em> genomes to identify recurring patterns of genetic variation. To infer transmission of specific mutations, we were tasked with constructing phylogenies for multiple clonal lineages, each comprising thousands of isolates(1).</p><p>Whole genome maximum likelihood phylogeny construction is a both time and computation-intensive process, especially for large numbers of tips. Moreover, as we were working with publicly available sequences, there is a lot of redundancy in the uploaded data. Presence of too many near-identical isolates would confound our phylogenetic trees -<em>too much data?</em></p><p><strong>So, how does one rationally reduce a large dataset while retaining as much of the diversity as possible?</strong> Especially when there’s a sampling bias leading to certain genotypes being sampled (or occurring naturally) more frequently than others? (In our case, for every mutant genotype, there were ~25 isolates with the WT genotype)</p><p>With the rapid growth of genome sequencing data, this is not an uncommon or even a new problem(2,3). There are several existing strategies for dereplicating genomes to reduce sample size - MASH, ANI, PopPunk. However, what methods are sensitive enough to actually distinguish between “identical” and “near-identical” genomes?</p><p>The “ideal” method would be to perform whole genome alignments and calculate SNP counts. As this would give us a pretty accurate picture of the exact number of nucleotide differences between two genomes. The disadvantage here is that this method does not scale well. Alignments become much slower when more samples are added. Therefore, we need fast methods to estimate the approximate pairwise distances between multiple genomes while also maintaining a reasonable level of accuracy.</p><p>How does a distance “approximation” method compare against a more robust metric like SNP distance? To answer this question, I used 380 strains from the Staphopia NRD set, a curated dataset of high quality <em>S. aureus</em> whole genomes comprising several Sequence Types and Clonal Complexes(4).</p><p>I performed core genome alignments with <a href=https://github.com/marbl/parsnp>parsnp </a>and calculated pairwise SNP distances using <a href=https://github.com/tseemann/snp-dists>snp-dists</a>. The size of the core genome for 380 diverse <em>S. aureus</em> strains is 1.56Mbp, while the average <em>S. aureus</em> genome size is 2.8Mbp. I also calculated pairwise MASH distances using mash dist. <a href=https://github.com/marbl/Mash>MASH </a>is a fast, accurate and relatively computationally inexpensive method to estimate the distance between two genomes. Tools like <a href=https://poppunk.readthedocs.io/en/latest/index.html>PopPunk</a> and <a href=https://github.com/rrwick/Assembly-Dereplicator>Assembly Dereplicator</a> use(d) MASH to estimate genomic distances (PopPunk now uses <a href=https://github.com/johnlees/pp-sketchlib>pp-sketchlib</a>). Then, I plotted the mash distance estimates for each alignment pair against the SNP distance.</p><p><img src=/images/Vishnu_Fig1.png alt=Fig1 title=Fig1></p><p>Overall, MASH Distance has great concordance with the SNP distance. But how well does mash perform for low SNP distances? Our goal was to ascertain possible transmission of specific mutant genotypes across generations, therefore we were interested in distinguishing closely related genomes. So, let’s zoom in to look at &lt; 50 SNPs</p><p><img src=/images/Vishnu_Fig2.png alt=Fig2 title=Fig2></p><p>The Red vertical line is the 50 SNP mark, the black horizontal line marks a MASH distance of 0.0005. Genomes &lt; 50 SNPs apart could have a MASH distance anywhere between 0 to 0.004 . Moreover, genomes 0 - 500 SNPs apart can all have a MASH dist between 0 - 0.005.</p><p><img src=/images/Vishnu_Fig3.png alt=Fig3 title=Fig3></p><p>The median SNP distances (red vertical line) for a MASH distance threshold &lt; 0.0005 and 0.001 are 47 and 56 respectively. For a MASH distance threshold of &lt; 0.05, the median SNP distance is 208.</p><p>How do you pick a MASH distance-based clustering threshold for comparing such closely related genomes?</p><p>This is subjective, as it depends on the research question. In our case, we were aware that our mutant genotypes would undergo few transmission events, and our main interest was in estimating the long-term transmission capabilities. Therefore, we settled on a threshold of 0.0005 (~47 SNPs). For <em>S. aureus</em>, this translates to an approximate of 1 - 2 transmission events(5). This means, our clustering threshold would collapse genomes that were ~2 transmission events apart.</p><p>No matter what MASH threshold is picked, the clustering is going to be less than ideal. Looking back at Fig 2, even with our strict threshold of 0.0005, the possibility of not collapsing genomes less than 50 SNPs apart still remains, as some pairs can have a mash distance of up to 0.004. This still leaves some redundancy in our final dataset. However, I do believe it is safer to err on the conservative side. Picking a lower threshold would only leave some redundancy whereas picking a higher threshold could collapse more unrelated genomes. In our case, this would lead to missing some intermediate - long-term transmission events.</p><h3 id=conclusions>Conclusions</h3><p>In conclusion - whichever dereplication method and cutoff is used, we need to know what that cutoff means in terms of the number of SNPs and the biological significance of that SNP distance. It is also important to note that not all dereplication tools are the same, even with the same cutoff(6).</p><h4 id=tldr-how-does-one-rationally-reduce-a-large-dataset-while-retaining-as-much-of-the-diversity-as-possible><strong>TL;DR:</strong> <strong>How does one rationally reduce a large dataset while retaining as much of the diversity as possible?</strong></h4><p>The following workflow worked well for us:</p><ol><li>From your initial large dataset, identify a small subset (~ 200 - 300 genomes) that captures the spectrum of genetic diversity.<ul><li>In our case, we used Staphopia’s NRD set which comprises many <em>S. aureus</em> sequence types.</li></ul></li><li>Using this small but diverse dataset, perform whole genome alignments and calculate pairwise SNP distances. Also perform pairwise distance estimations using your genomic distance approximation method of choice (eg: MASH, ANI).<ul><li>We used parsnp and MASH respectively. The SNP distances may also vary based on the genome alignment method used.</li></ul></li><li>Based on your biological question, select a distance approximation cutoff based on its concordance with the number of SNPs [Fig 1]<ul><li>We used a MASH distance cutoff of 0.0005 (~47 SNPs or 1 - 2 transmission events)</li></ul></li><li>Repeat your pairwise distance estimation method but now with ALL your data and cluster based on your chosen threshold.</li></ol><p><strong>References</strong></p><ol><li>Raghuram V, Alexander AM, Loo HQ, Petit RA 3rd, Goldberg JB, Read TD. Species-Wide Phylogenomics of the Staphylococcus aureus <em>Agr</em> Operon Revealed Convergent Evolution of Frameshift Mutations. Microbiol Spectr. 2022 Jan 19:e0133421. doi: 10.1128/spectrum.01334-21. Epub ahead of print. PMID: 35044202.</li><li>Genbank and WGS statistics. <a href=https://www.ncbi.nlm.nih.gov/genbank/statistics/>https://www.ncbi.nlm.nih.gov/genbank/statistics/</a></li><li>Aldhous P. Managing the genome data deluge. Science. 1993 Oct 22;262(5133):502-3. doi: 10.1126/science.8211171. PMID: 8211171.</li><li>Petit RA 3rd, Read TD. <em>Staphylococcus aureus</em> viewed from the perspective of 40,000+ genomes. PeerJ. 2018 Jul 12;6:e5261. doi: 10.7717/peerj.5261. PMID: 30013858; PMCID: PMC6046195.</li><li>Hall MD, Holden MT, Srisomang P, Mahavanakul W, Wuthiekanun V, Limmathurotsakul D, Fountain K, Parkhill J, Nickerson EK, Peacock SJ, Fraser C. Improved characterisation of MRSA transmission using within-host bacterial sequence diversity. Elife. 2019 Oct 8;8:e46402. doi: 10.7554/eLife.46402. PMID: 31591959; PMCID: PMC6954020.</li><li>Evans JT, Denef VJ. To Dereplicate or Not To Dereplicate? mSphere. 2020 May 20;5(3):e00971-19. doi: 10.1128/mSphere.00971-19. PMID: 32434845; PMCID: PMC7380574.</li></ol><ul class=pa0></ul><div class=mt6></div></section><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://read-lab-confederation.github.io>&copy; 2026 EMERGENT</a><div><a class=resp-sharing-button__link href="https://bsky.app/intent/compose?text=Check out EMERGENT, a bacterial genomics and metagenomics blog from Timothy Read's group! https://read-lab-confederation.github.io" target=_blank rel=noopener aria-label="Share on BlueSky"><div class="resp-sharing-button resp-sharing-button--bluesky resp-sharing-button--large"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908.0 3.08.0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741.0 01-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478.0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"/></svg></div>Share on BlueSky</div></a></div></div></footer><script src=/dist/js/app.3fc0f988d21662902933.js></script><script src=/js/custom.js></script></body></html>